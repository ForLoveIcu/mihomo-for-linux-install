# Mihomo Linux 安装脚本资源配置文件
# 版本: v2.2.1
# 更新时间: 2025-08-07

# =============================================================================
# 核心组件版本信息
# =============================================================================

# Mihomo 核心版本
MIHOMO_VERSION="v1.19.12"
MIHOMO_REPO="MetaCubeX/mihomo"

# WebUI 版本和配置
WEBUI_VERSION="v1.19.12"
WEBUI_REPO="MetaCubeX/metacubexd"

# 前端界面选择 (metacubexd, zashboard)
DEFAULT_FRONTEND="metacubexd"

# MetaCubeXD 前端配置
METACUBEXD_VERSION="v1.19.12"
METACUBEXD_REPO="MetaCubeX/metacubexd"

# Zashboard 前端配置
ZASHBOARD_VERSION="latest"
ZASHBOARD_REPO="Zephyruso/zashboard"

# GeoIP 数据库版本
GEOIP_VERSION="20241201"
GEOIP_REPO="MetaCubeX/meta-rules-dat"

# =============================================================================
# 架构映射配置
# =============================================================================

# x86_64 架构文件映射
ARCH_x86_64_MIHOMO="mihomo-linux-amd64-v1-v1.19.12.gz"
ARCH_x86_64_NAME="amd64"

# ARM64 架构文件映射
ARCH_aarch64_MIHOMO="mihomo-linux-arm64-v1.19.12.gz"
ARCH_arm64_MIHOMO="mihomo-linux-arm64-v1.19.12.gz"
ARCH_aarch64_NAME="arm64"
ARCH_arm64_NAME="arm64"

# ARMv7 架构文件映射
ARCH_armv7l_MIHOMO="mihomo-linux-armv7-v1.19.12.gz"
ARCH_armv7l_NAME="armv7"

# =============================================================================
# 下载地址模板
# =============================================================================

# GitHub 原始地址模板
GITHUB_RELEASE_URL="https://github.com/{REPO}/releases/download/{VERSION}/{FILE}"

# Mihomo 核心下载地址
MIHOMO_DOWNLOAD_URL="https://github.com/MetaCubeX/mihomo/releases/download/v1.19.12"

# WebUI 下载地址 (兼容性保持)
WEBUI_DOWNLOAD_URL="https://github.com/MetaCubeX/metacubexd/releases/download/v1.19.12/compressed-dist.tgz"

# MetaCubeXD 前端下载地址
METACUBEXD_DOWNLOAD_URL="https://github.com/MetaCubeX/metacubexd/releases/download/v1.19.12/compressed-dist.tgz"

# Zashboard 前端下载地址
ZASHBOARD_DOWNLOAD_URL="https://github.com/Zephyruso/zashboard/releases/latest/download/dist-cdn-fonts.zip"

# GeoIP 数据库下载地址
GEOIP_DOWNLOAD_URL="https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb"

# =============================================================================
# GitHub 镜像加速服务列表
# =============================================================================

# 主要镜像服务（按优先级排序）
MIRRORS=(
    "https://ghfast.top/"
    "https://github.moeyy.xyz/"
    "https://gh.h233.eu.org/"
    "https://cors.isteed.cc/github.com"
    "https://hub.gitmirror.com/"
    "https://github.boki.moe/"
    "https://gh-proxy.net/"
    "https://ghproxy.net/"
    "https://gh-proxy.com/"
    "https://mirror.ghproxy.com/"
    "https://ghproxy.com/"
    ""  # 原始地址作为最后备选
)

# =============================================================================
# 系统配置
# =============================================================================

# 支持的系统列表
SUPPORTED_SYSTEMS=(
    "debian"
    "ubuntu" 
    "centos"
    "rocky"
    "fedora"
    "arch"
)

# 默认端口配置
DEFAULT_HTTP_PORT="7890"
DEFAULT_SOCKS_PORT="7891"
DEFAULT_API_PORT="9090"
DEFAULT_DNS_PORT="53"

# =============================================================================
# 安装路径配置
# =============================================================================

# 安装目录
INSTALL_DIR="/opt/mihomo"
CONFIG_DIR="/etc/mihomo"
SERVICE_FILE="/etc/systemd/system/mihomo.service"

# 便捷命令路径
COMMAND_DIR="/usr/local/bin"
COMMANDS=("clashon" "clashoff" "clashstatus" "clashlog" "clashrestart")

# =============================================================================
# 下载配置
# =============================================================================

# 下载超时设置
CONNECT_TIMEOUT="8"
DOWNLOAD_TIMEOUT="120"
MAX_RETRY_ATTEMPTS="3"

# 文件验证设置
MIN_FILE_SIZE="1000"  # 最小文件大小（字节）
INVALID_FORMATS=("HTML" "text" "XML")  # 无效文件格式

# =============================================================================
# 日志配置
# =============================================================================

# 日志级别
LOG_LEVEL="info"

# 颜色配置
COLOR_RED='\033[0;31m'
COLOR_GREEN='\033[0;32m'
COLOR_YELLOW='\033[1;33m'
COLOR_BLUE='\033[0;34m'
COLOR_NC='\033[0m'

# =============================================================================
# 功能开关
# =============================================================================

# 是否启用文件格式验证
ENABLE_FILE_VALIDATION="true"

# 是否启用文件大小验证
ENABLE_SIZE_VALIDATION="true"

# 是否启用自动重试
ENABLE_AUTO_RETRY="true"

# 是否启用详细日志
ENABLE_VERBOSE_LOG="true"

# =============================================================================
# 备用资源地址（离线安装用）
# =============================================================================

# 项目内置资源路径
BUILTIN_RESOURCES_DIR="binaries"

# 内置文件映射
BUILTIN_MIHOMO_AMD64="mihomo-linux-amd64-v1-v1.19.12.gz"
BUILTIN_MIHOMO_ARM64="mihomo-linux-arm64-v1.19.12.gz"
BUILTIN_MIHOMO_ARMV7="mihomo-linux-armv7-v1.19.12.gz"
BUILTIN_WEBUI="metacubexd.tgz"
BUILTIN_GEOIP="Country.mmdb"

# =============================================================================
# 版本检查配置
# =============================================================================

# GitHub API 地址
GITHUB_API_BASE="https://api.github.com/repos"

# 版本检查 URL
MIHOMO_VERSION_CHECK_URL="https://api.github.com/repos/MetaCubeX/mihomo/releases/latest"
WEBUI_VERSION_CHECK_URL="https://api.github.com/repos/MetaCubeX/metacubexd/releases/latest"

# =============================================================================
# 配置文件模板
# =============================================================================

# 默认配置文件路径
DEFAULT_CONFIG_TEMPLATE="config.yaml"

# 服务文件模板路径
SERVICE_TEMPLATE="mihomo.service"

# =============================================================================
# 更新说明
# =============================================================================

# 配置文件版本
CONFIG_VERSION="2.2.1"

# 最后更新时间
LAST_UPDATE="2025-08-07"

# 更新说明
UPDATE_NOTES="
v2.2.1 更新内容:
- 固定 Mihomo 版本为 v1.19.12
- 优化架构检测和文件映射
- 完善镜像服务列表
- 添加详细的资源配置管理
"
